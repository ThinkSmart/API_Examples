# Workflow_via_CSV

The files in this folder can be used for "batch processing" of a workflow, i.e. submitting the initial stage of a workflow any number of times, with potentially different field values in each instance. Specifically, [Initiate_Template.py](https://github.com/ThinkSmart/API_Examples/blob/master/Workflow_via_CSV/initTemplate.py?ts=2) retrieves an access token via resource owner flow, gets the template ID for the workflow of interest, and uses data in a CSV file to initiate workflows. Calls to the ThinkSmart API are done with functions from [Initiate_Functions.py](https://github.com/ThinkSmart/API_Examples/blob/master/Workflow_via_CSV/initFunctions.py?ts=2), which are imported to the template file. This was done for readability and reusability. 

Although [Example1.py](https://github.com/ThinkSmart/API_Examples/blob/master/Example1.py?ts=2) also uses resource owner flow to initiate a workflow, the files here offer a bit more functionality. Namely, field values come from a CSV (rather than the script itself), and a particular workflow can be initiated more than once because the script loops through each row of the CSV. Also, the template file creates a new txt file (in the same directory) each time it's run, and writes the result of each submission, including error messages. 

The script can detect a number of errors. First, it checks that all the global variables are valid. Any errors there will cause the script to quit (the ability to get a token, template ID, or data from the CSV is disrupted). It's also possible for errors to occur with certain rows of the CSV (i.e. required field is empty, value doesn't match options in dropdown, etc.) The script won't quit in that case, but that row won't be submitted successfully. Lastly, the script checks whether the field names in the workflow match the field names in the CSV. If any of these errors occur, they'll appear in the txt file. 

To get started, create a workflow in TAP and be sure to leave the field names unchanged (i.e. element1). Create a CSV (preferably UTF-8 encoded) based on your workflow, where the first row is field labels and subsequent rows are field values. Then, update the global variables in the template file. This includes the client ID and secret for your tenant, as well as the name of your workflow and CSV. Make sure your CSV is in the same directory as the template and function files. You'll be prompted to enter your TAP username and password during runtime. 
